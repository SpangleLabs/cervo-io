<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
Animals list:
<ul id="animals"></ul>
</body>

<script>
    function add_category(element, categoryData) {
        var categoryId = categoryData.category_id;
        var name = categoryData.name;
        var categoryLiId = "category-"+categoryId;
        element.append("<li class='category' id='"+categoryLiId+"'>" +
            "<span onclick='load_category("+categoryId+")'>"+name+"</span>" +
            "</li>");
    }

    function add_species(element, speciesData) {
        var speciesId = speciesData.species_id;
        var name = speciesData.common_name;
        var latinName = speciesData.latin_name;
        element.append("<li class='species'>"+name+" <span class='latin_name'>"+latinName+"</span></li>");
    }

    function load_category(id) {
        var categoryLiId = "category-"+id;
        $.get("http://localhost:3000/categories/"+id, function(data) {
            var listElement = $("#"+categoryLiId);
            if(!listElement.has("ul").length) {
                console.log("hello");
                listElement.append("<ul></ul>");
                $.each(data[0].sub_categories, function (index, itemData) {
                    add_category(listElement.find("ul"), itemData);
                });
                $.each(data[0].species, function (index, itemData) {
                    add_species(listElement.find("ul"), itemData);
                });
            } else {
                listElement.find("ul").toggle();
            }
        })
    }

    $(document).ready(function() {
        $.get("http://localhost:3000/categories/", function(data) {
            $.each(data, function(index, itemData) {
                add_category($("#animals"), itemData);
            });
        });
    });
</script>
</html>